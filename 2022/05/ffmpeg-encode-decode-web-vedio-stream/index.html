<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢ - è±†æµ†çš„åšå®¢</title><meta name=Description content="è±†æµ†çš„åšå®¢"><meta property="og:title" content="ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢"><meta property="og:description" content="å‰ç½®çŸ¥è¯† å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼ è§†é¢‘ ITU-T: H.261ã€H.263ã€H.263+ã€H.264 MPEG: MPEG-1ã€MPEG-2ã€MPEG-4 éŸ³é¢‘ AACï¼ŒMP3"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-19T11:56:40+08:00"><meta property="article:modified_time" content="2022-05-20T17:04:27+08:00"><meta property="og:site_name" content="è±†æµ†çš„åšå®¢"><meta name=twitter:card content="summary"><meta name=twitter:title content="ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢"><meta name=twitter:description content="å‰ç½®çŸ¥è¯† å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼ è§†é¢‘ ITU-T: H.261ã€H.263ã€H.263+ã€H.264 MPEG: MPEG-1ã€MPEG-2ã€MPEG-4 éŸ³é¢‘ AACï¼ŒMP3"><meta name=application-name content="è±†æµ†çš„åšå®¢"><meta name=apple-mobile-web-app-title content="è±†æµ†çš„åšå®¢"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/><link rel=prev href=https://blog.lomot.cn/2022/05/count-of-smaller-numbers-after-self/><link rel=stylesheet href=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.lomot.cn\/2022\/05\/ffmpeg-encode-decode-web-vedio-stream\/"},"genre":"posts","keywords":"ffmpeg","wordcount":1712,"url":"https:\/\/blog.lomot.cn\/2022\/05\/ffmpeg-encode-decode-web-vedio-stream\/","datePublished":"2022-05-19T11:56:40+08:00","dateModified":"2022-05-20T17:04:27+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"lomot"},"author":{"@type":"Person","name":"lomot"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=è±†æµ†çš„åšå®¢>è±†æµ†çš„åšå®¢</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>æ‰€æœ‰æ–‡ç«  </a><a class=menu-item href=/tags/>æ ‡ç­¾ </a><a class=menu-item href=/categories/>åˆ†ç±» </a><a class=menu-item href=/about/>å…³äº </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜>
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=è±†æµ†çš„åšå®¢>è±†æµ†çš„åšå®¢</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>æ‰€æœ‰æ–‡ç« </a><a class=menu-item href=/tags/ title>æ ‡ç­¾</a><a class=menu-item href=/categories/ title>åˆ†ç±»</a><a class=menu-item href=/about/ title>å…³äº</a><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>ç›®å½•</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>lomot</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-05-19>2022-05-19</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 1712 å­—&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 4 åˆ†é’Ÿ&nbsp;<span id=/2022/05/ffmpeg-encode-decode-web-vedio-stream/ class=leancloud_visitors data-flag-title=ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢>
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;æ¬¡é˜…è¯»
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#å‰ç½®çŸ¥è¯†>å‰ç½®çŸ¥è¯†</a><ul><li><a href=#å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼>å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼</a></li><li><a href=#è§†é¢‘å°è£…æ ¼å¼>è§†é¢‘å°è£…æ ¼å¼</a></li><li><a href=#æµåª’ä½“ä¼ è¾“æ–¹æ¡ˆ>æµåª’ä½“ä¼ è¾“æ–¹æ¡ˆ</a></li><li><a href=#ç½‘ç»œç›´æ’­å»¶è¿Ÿ>ç½‘ç»œç›´æ’­å»¶è¿Ÿ</a></li></ul></li><li><a href=#ffmpeg>ffmpeg</a><ul><li><a href=#å…¸å‹å·¥ä½œæµç¨‹>å…¸å‹å·¥ä½œæµç¨‹</a></li><li><a href=#æ»¤æ³¢>æ»¤æ³¢</a></li><li><a href=#ffmpeg-å‘½ä»¤è¡Œç¤ºä¾‹>ffmpeg å‘½ä»¤è¡Œç¤ºä¾‹</a></li><li><a href=#ffmpeg-å‚æ•°>ffmpeg å‚æ•°</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=å‰ç½®çŸ¥è¯†>å‰ç½®çŸ¥è¯†</h2><h3 id=å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼>å¸¸è§éŸ³è§†é¢‘ç¼–ç æ ¼å¼</h3><ul><li><p>è§†é¢‘</p><ul><li>ITU-T: H.261ã€H.263ã€H.263+ã€H.264</li><li>MPEG: MPEG-1ã€MPEG-2ã€MPEG-4</li></ul></li><li><p>éŸ³é¢‘</p><ul><li>AACï¼ŒMP3ï¼ŒWMA</li></ul></li></ul><h3 id=è§†é¢‘å°è£…æ ¼å¼>è§†é¢‘å°è£…æ ¼å¼</h3><blockquote><p>AVI : å¯ç”¨ MPEG-2, DIVX, XVID, WMV3, WMV4, AC-1, H.264
WMV : å¯ç”¨ WMV3, WMV4, AC-1
RM/RMVB : å¯ç”¨ RV40, RV50, RV60, RM8, RM9, RM10
MOV : å¯ç”¨ MPEG-2, MPEG4-ASP(XVID), H.264
MKV : æ‰€æœ‰</p></blockquote><blockquote><p>FLV: å°è£…æœ‰è¾ƒä¸ºä¸¥æ ¼çš„éŸ³è§†é¢‘ç¼–ç é™åˆ¶ï¼Œå³ FLV å°è£…çš„éŸ³é¢‘æ ¼å¼ä»¥ AAC/MP3/SPEEX ä¸ºä¸»ï¼Œè§†é¢‘ä»¥ H264 ä¸ºä¸»</p></blockquote><h3 id=æµåª’ä½“ä¼ è¾“æ–¹æ¡ˆ>æµåª’ä½“ä¼ è¾“æ–¹æ¡ˆ</h3><ul><li><p>RTSP (å›½æ ‡ GB28181)
ä½¿ç”¨ RTP å°è£…è§†é¢‘æµ, åŸºäº udp, è§†é¢‘ç¼–ç å¸¸ä¸º MPEG-4/H.264/SVAC, éŸ³é¢‘ G.711/G.723.1/G.729</p></li><li><p>RTMP (adobe)
è§†é¢‘å¿…é¡»æ˜¯ H264 ç¼–ç ï¼ŒéŸ³é¢‘å¿…é¡»æ˜¯ AAC æˆ– MP3 ç¼–ç ï¼Œä¸”å¤šä»¥ flv æ ¼å¼å°åŒ…
(FLV å°è£…æœ‰è¾ƒä¸ºä¸¥æ ¼çš„éŸ³è§†é¢‘ç¼–ç é™åˆ¶ï¼Œå³ FLV å°è£…çš„éŸ³é¢‘æ ¼å¼ä»¥ AAC/MP3/SPEEX ä¸ºä¸»ï¼Œè§†é¢‘åˆ™ä»¥ H264 ä¸ºä¸»).</p></li><li><p>http-flv (adobe)
ç›¸å½“äº http ç‰ˆæœ¬çš„ rtmp, ä½¿ç”¨ http ä¼ è¾“ flv å°è£…çš„è§†é¢‘æµ</p></li><li><p>HLS(apple)
æœåŠ¡å™¨ç«¯ä¼šå°†æœ€æ–°çš„ç›´æ’­æ•°æ®ç”Ÿæˆæ–°çš„å°æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯åªè¦ä¸åœçš„æŒ‰é¡ºåºæ’­æ”¾ä»æœåŠ¡å™¨è·å–åˆ°çš„æ–‡ä»¶ï¼Œå°±å®ç°äº†ç›´æ’­.åŸºæœ¬ä¸Šï¼ŒHLS æ˜¯ä»¥ç‚¹æ’­çš„æŠ€æœ¯å®ç°äº†ç›´æ’­çš„ä½“éªŒã€‚å› ä¸ºæ¯ä¸ªå°æ–‡ä»¶çš„æ—¶é•¿å¾ˆçŸ­ï¼Œå®¢æˆ·ç«¯å¯ä»¥å¾ˆå¿«åœ°åˆ‡æ¢ç ç‡ï¼Œä»¥é€‚åº”ä¸åŒå¸¦å®½æ¡ä»¶ä¸‹çš„æ’­æ”¾ã€‚
ä¼ è¾“å†…å®¹åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šä¸€æ˜¯ M3U8 æè¿°æ–‡ä»¶ï¼ŒäºŒæ˜¯ TS åª’ä½“æ–‡ä»¶ã€‚TS åª’ä½“æ–‡ä»¶ä¸­çš„è§†é¢‘å¿…é¡»æ˜¯ H264 ç¼–ç ï¼ŒéŸ³é¢‘å¿…é¡»æ˜¯ AAC æˆ– MP3 ç¼–ç ã€‚</p></li><li><p>WebRTC
åŸºäº udp è§†é¢‘å°è£…ä½¿ç”¨ RTP/RTCP, ä¾§é‡ p2p è§†é¢‘ä¼šè®®
<img class=lazyload src=/svg/loading.min.svg data-src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/img/markdown/2022/webrtc_protocol.jpg data-srcset="https://static-1251996892.cos.ap-chengdu.myqcloud.com/img/markdown/2022/webrtc_protocol.jpg, https://static-1251996892.cos.ap-chengdu.myqcloud.com/img/markdown/2022/webrtc_protocol.jpg 1.5x, https://static-1251996892.cos.ap-chengdu.myqcloud.com/img/markdown/2022/webrtc_protocol.jpg 2x" data-sizes=auto alt=https://static-1251996892.cos.ap-chengdu.myqcloud.com/img/markdown/2022/webrtc_protocol.jpg title=WebRTCåè®®æ ˆ></p></li></ul><h3 id=ç½‘ç»œç›´æ’­å»¶è¿Ÿ>ç½‘ç»œç›´æ’­å»¶è¿Ÿ</h3><ul><li>RTMP åè®®åŸºäº TCP æ¥å®ç°ï¼Œæ¯ä¸ªæ—¶åˆ»çš„æ•°æ®ï¼Œæ”¶åˆ°åç«‹åˆ»è½¬å‘ï¼Œä¸€èˆ¬å»¶è¿Ÿåœ¨ 1-3s å·¦å³</li><li>HTTP-FLV åŸºäº HTTP é•¿è¿æ¥ï¼Œé€š RTMP ä¸€æ ·ï¼Œæ¯ä¸ªæ—¶åˆ»çš„æ•°æ®ï¼Œæ”¶åˆ°åç«‹åˆ»è½¬å‘ï¼Œåªä¸è¿‡ä½¿ç”¨çš„æ˜¯ HTTP åè®®ï¼Œä¸€èˆ¬å»¶è¿Ÿåœ¨ 1-3s</li><li>HLS åè®®åŸºäº HTTP çŸ­è¿æ¥æ¥å®ç°ï¼Œé›†åˆä¸€æ®µæ—¶é—´æ•°æ®ï¼Œç”Ÿæˆ ts åˆ‡ç‰‡æ–‡ä»¶ï¼Œç„¶åæ›´æ–° m3u8(HTTP Live Streaming ç›´æ’­çš„ç´¢å¼•æ–‡ä»¶)ï¼Œä¸€èˆ¬å»¶è¿Ÿä¼šå¤§äº 10s</li></ul><h2 id=ffmpeg>ffmpeg</h2><h3 id=å…¸å‹å·¥ä½œæµç¨‹>å…¸å‹å·¥ä½œæµç¨‹</h3><ul><li>ç¼–è§£ç </li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> _______              ______________
</span></span><span class=line><span class=cl>|       |            |              |
</span></span><span class=line><span class=cl>| input |  demuxer   | encoded data |   decoder
</span></span><span class=line><span class=cl>| file  | ---------&gt; | packets      | -----+
</span></span><span class=line><span class=cl>|_______|            |______________|      |
</span></span><span class=line><span class=cl>                                           v
</span></span><span class=line><span class=cl>                                      _________
</span></span><span class=line><span class=cl>                                     |         |
</span></span><span class=line><span class=cl>                                     | decoded |
</span></span><span class=line><span class=cl>                                     | frames  |
</span></span><span class=line><span class=cl>                                     |_________|
</span></span><span class=line><span class=cl> ________             ______________       |
</span></span><span class=line><span class=cl>|        |           |              |      |
</span></span><span class=line><span class=cl>| output | &lt;-------- | encoded data | &lt;----+
</span></span><span class=line><span class=cl>| file   |   muxer   | packets      |   encoder
</span></span><span class=line><span class=cl>|________|           |______________|
</span></span></code></pre></td></tr></table></div></div><ul><li>æµæ‹·è´</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> _______              ______________            ________
</span></span><span class=line><span class=cl>|       |            |              |          |        |
</span></span><span class=line><span class=cl>| input |  demuxer   | encoded data |  muxer   | output |
</span></span><span class=line><span class=cl>| file  | ---------&gt; | packets      | -------&gt; | file   |
</span></span><span class=line><span class=cl>|_______|            |______________|          |________|
</span></span></code></pre></td></tr></table></div></div><h3 id=æ»¤æ³¢>æ»¤æ³¢</h3><p>åœ¨ç¼–ç ä¹‹å‰ï¼ŒFFmpeg é€šè¿‡è°ƒç”¨ libavfilter åº“çš„æ»¤æ³¢å™¨ï¼ˆfiltersï¼‰æ¥å¤„ç†åŸç”Ÿï¼ˆrawï¼‰éŸ³é¢‘å’Œè§†é¢‘å¸§ã€‚æˆ‘ä»¬å°†ç”±å¤šä¸ªæ»¤æ³¢å™¨ï¼ˆchained filtersï¼‰ç»„æˆçš„é“¾å¼ç»“æ„ç§°ä¸ºæ»¤æ³¢å›¾ï¼ˆfilter graphï¼‰ã€‚ffmpeg ä¸­åŒºåˆ†ä¸¤ç±»æ»¤æ³¢å›¾ï¼šç®€å•çš„ï¼ˆsimpleï¼‰å’Œå¤æ‚çš„(complex)ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> _________                        ______________
</span></span><span class=line><span class=cl>|         |                      |              |
</span></span><span class=line><span class=cl>| decoded |                      | encoded data |
</span></span><span class=line><span class=cl>| frames  |\                   _ | packets      |
</span></span><span class=line><span class=cl>|_________| \                  /||______________|
</span></span><span class=line><span class=cl>             \   __________   /
</span></span><span class=line><span class=cl>  simple     _\||          | /  encoder
</span></span><span class=line><span class=cl>  filtergraph   | filtered |/
</span></span><span class=line><span class=cl>                | frames   |
</span></span><span class=line><span class=cl>                |__________|
</span></span></code></pre></td></tr></table></div></div><ul><li>simple filtergraph</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> _______        _____________        _______        ________
</span></span><span class=line><span class=cl>|       |      |             |      |       |      |        |
</span></span><span class=line><span class=cl>| input | ---&gt; | deinterlace | ---&gt; | scale | ---&gt; | output |
</span></span><span class=line><span class=cl>|_______|      |_____________|      |_______|      |________|
</span></span></code></pre></td></tr></table></div></div><h3 id=ffmpeg-å‘½ä»¤è¡Œç¤ºä¾‹>ffmpeg å‘½ä»¤è¡Œç¤ºä¾‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ffmpeg æ¨¡æ¿</span>
</span></span><span class=line><span class=cl>ffmpeg -i INPUT -c:v libx264 -c:a copy OUTPUT
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ffmpeg ä»æ–‡ä»¶æ¨åˆ° rtmp</span>
</span></span><span class=line><span class=cl>ffmpeg -re -stream_loop -1 -i input.mp4 -c copy -f flv -y rtmp://192.168.20.6:1937/live/stream114514
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ffmpeg ä»æ–‡ä»¶æ¨åˆ° rtsp</span>
</span></span><span class=line><span class=cl>ffmpeg -re -stream_loop -1 -i v2.mp4 -rtsp_transport tcp -c copy -f rtsp rtsp://localhost:8554/rtsp233
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ffmpeg è½¬ç æ¨åˆ° rtmp</span>
</span></span><span class=line><span class=cl>ffmpeg -re -stream_loop -1 -i input.mp4 -c:v libx264 -c:a aac -f flv -y rtmp://192.168.20.6:1937/live/stream114514
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ffmpeg è½¬ç å¹¶é™åˆ¶ç ç‡å¸§æ•°åˆ†è¾¨ç‡æ¨åˆ° rtmp</span>
</span></span><span class=line><span class=cl>ffmpeg -re -stream_loop -1 -i input.mp4 -c:v libx264 -c:a aac -b:v 2000k -b:a 32k -r <span class=m>24</span> -s 640x480 -f flv -y rtmp://192.168.20.6:1937/live/stream114514
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># ä¿å­˜æµåˆ°æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>ffmpeg -i rtsp://192.168.20.6:8554/rtsp233 -c copy dump.flv
</span></span><span class=line><span class=cl>ffmpeg -i rtmp://10.244.2.150:1935/live/test12345 -c copy dump.flv
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># rtsp to rtmp</span>
</span></span><span class=line><span class=cl>ffmpeg -i rtsp://192.168.20.6:8554/rtsp233 -f flv -an rtmp://192.168.20.6:1937/live/stream114514
</span></span></code></pre></td></tr></table></div></div><h3 id=ffmpeg-å‚æ•°>ffmpeg å‚æ•°</h3><ul><li><p>-f fmt (input/output)
Force input or output file format. The format is normally auto detected for input files and guessed from the file extension for output files, so this option is not needed in most cases.</p></li><li><p>-re (input)
Read input at native frame rate. This is equivalent to setting -readrate 1.</p></li><li><p>-y (global)
Overwrite output files without asking.</p></li><li><p>-stream_loop number (input)
Set number of times input stream shall be looped. Loop 0 means no loop, loop -1 means infinite loop.</p></li><li><p>-c[:stream_specifier] -codec[:stream_specifier] codec (input/output,per-stream)
Select an encoder (when used before an output file) or a decoder (when used before an input file) for one or more streams. codec is the name of a decoder/encoder or a special value copy (output only) to indicate that the stream is not to be re-encoded.</p></li><li><p>-vframes number (output)
Set the number of video frames to output. This is an obsolete alias for -frames:v, which you should use instead.</p></li><li><p>-map é€‰é¡¹(å¤šéŸ³è½¨, å­—å¹•æµç›¸å…³, åªåœ¨å°è£…æ–‡ä»¶ä¸­æœ‰å¤§ä½™ä¸€è·¯è§†é¢‘æµå’Œä¸€è·¯éŸ³é¢‘æµçš„æ—¶å€™éœ€è¦è€ƒè™‘, ä¸è§†é¢‘æ¨æ‹‰æµç›¸å…³ä¸å¤§)</p><p><a href=https://blog.csdn.net/xiaoluer/article/details/81136478 target=_blank rel="noopener noreffer">å¼•ç”¨: fmpeg å‘½ä»¤è¡Œ map å‚æ•°çš„ä½¿ç”¨</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># fmpeg -i input.mkv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ffmpeg version ... Copyright (c) 2000-2012 the FFmpeg developers
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Input #0, matroska,webm, from &#39;input.mkv&#39;:
</span></span><span class=line><span class=cl>  Duration: 01:39:44.02, start: 0.000000, bitrate: 5793 kb/s
</span></span><span class=line><span class=cl>    Stream #0:0(eng): Video: h264 (High), yuv420p, 1920x800, 23.98 fps, 23.98 tbr, 1k tbn, 47.95 tbc (default)
</span></span><span class=line><span class=cl>    Stream #0:1(ger): Audio: dts (DTS), 48000 Hz, 5.1(side), s16, 1536 kb/s (default)
</span></span><span class=line><span class=cl>    Stream #0:2(eng): Audio: dts (DTS), 48000 Hz, 5.1(side), s16, 1536 kb/s
</span></span><span class=line><span class=cl>    Stream #0:3(ger): Subtitle: text (default)
</span></span><span class=line><span class=cl>At least one output file must be specified
</span></span></code></pre></td></tr></table></div></div><blockquote><p>é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬è¯´æˆ‘ä»¬æƒ³è¦ï¼š</p><ul><li>å°†è§†é¢‘æµå¤åˆ¶</li><li>å°†å¾·è¯­éŸ³é¢‘æµç¼–ç ä¸º MP3ï¼ˆ128kbpsï¼‰å’Œ AACï¼ˆ96kbpsï¼‰ï¼ˆåœ¨è¾“å‡ºä¸­åˆ›å»ºä¸¤ä¸ªéŸ³é¢‘æµï¼‰</li><li>å°†è‹±è¯­éŸ³é¢‘æµåˆ é™¤</li><li>å°†å­—å¹•æµå¤åˆ¶</li><li>è¿™å¯ä»¥ç”¨ä»¥ä¸‹çš„ ffmpeg å‘½ä»¤æ¥å®Œæˆï¼š</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ffmpeg -i input.mkv \
</span></span><span class=line><span class=cl>    -map 0:0 -map 0:1 -map 0:1 -map 0:3 \
</span></span><span class=line><span class=cl>    -c:v copy \
</span></span><span class=line><span class=cl>    -cğŸ…°ï¸0 libmp3lame -bğŸ…°ï¸0 128k \
</span></span><span class=line><span class=cl>    -cğŸ…°ï¸1 libfaac -bğŸ…°ï¸1 96k \
</span></span><span class=line><span class=cl>    -c:s copy \
</span></span><span class=line><span class=cl>    output.mkv
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„ä¸€ä¸‹å‚æ•°é‡Œæ²¡æœ‰â€œ-map 0:2â€ï¼Œå¹¶ä¸”â€œ-map 0:1â€è¢«å†™äº†ä¸¤æ¬¡ã€‚
ä½¿ç”¨â€œ-map 0:0 -map 0:1 -map 0:1 -map 0:3â€ï¼Œæˆ‘ä»¬å‘Šè¯‰ ffmpeg é€‰æ‹©/æ˜ å°„æŒ‡å®šçš„è¾“å…¥æµæŒ‰ç›¸åº”é¡ºåºè¾“å‡ºã€‚
å› æ­¤ï¼Œæˆ‘ä»¬çš„è¾“å‡ºå°†å…·æœ‰ä»¥ä¸‹æµï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Output #0, matroska, to &#39;output.mkv&#39;:
</span></span><span class=line><span class=cl>    Stream #0:0(eng): Video ...
</span></span><span class=line><span class=cl>    Stream #0:1(ger): Audio ...
</span></span><span class=line><span class=cl>    Stream #0:2(ger): Audio ...
</span></span><span class=line><span class=cl>    Stream #0:3(ger): Subtitle ...
</span></span></code></pre></td></tr></table></div></div></blockquote></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>æ›´æ–°äº 2022-05-20&nbsp;<a class=git-hash href=https://github.com/dillonzq/LoveIt/commit/4aefb1b604129c627a425aa7e9259e123b9f4361 target=_blank title="commit by lomot(lomot@qq.com) 4aefb1b604129c627a425aa7e9259e123b9f4361: update content">
<i class="fas fa-hashtag fa-fw"></i>4aefb1b</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° Twitter" data-sharer=twitter data-url=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/ data-title=ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢ data-via=lomotco data-hashtags=ffmpeg><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/ data-hashtag=ffmpeg><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/ data-title=ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢ data-ralateuid=5676214854><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° äººäºº" data-sharer=renren data-url=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/><i class="fab fa-renren fa-fw"></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Evernote" data-sharer=evernote data-url=https://blog.lomot.cn/2022/05/ffmpeg-encode-decode-web-vedio-stream/ data-title=ç½‘ç»œè§†é¢‘æµä¼ è¾“ä¸ffmpegç¼–è§£ç æ¨æ‹‰æµåˆæ¢><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/ffmpeg/>ffmpeg</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/2022/05/count-of-smaller-numbers-after-self/ class=prev rel=prev title=ç®—æ³•ç¬”è®°--è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°><i class="fas fa-angle-left fa-fw"></i>ç®—æ³•ç¬”è®°--è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°</a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>ç”± <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.99.1">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2016 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>lomot</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a href=http://beian.miit.gov.cn target=_blank class=text rel=nofollow>çš–ICPå¤‡20012790å·-1</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=å›åˆ°é¡¶éƒ¨><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=æŸ¥çœ‹è¯„è®º><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><link rel=stylesheet href=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/lightgallery.js@1.2.0/dist/css/lightgallery.min.css><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/valine@1.4.14/dist/Valine.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/lightgallery.js@1.2.0/dist/js/lightgallery.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/lg-zoom.js@1.2.0/dist/lg-zoom.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://static-1251996892.cos.ap-chengdu.myqcloud.com/LoveItLib_0.2.10/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",maxShownLines:1e3},comment:{valine:{appId:"I7PtpjsuKSpR2qhMaq7JJXQt-MdYXbMMI",appKey:"B9kjrXLA5NJLrUT0PhLfPb2n",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"zh-cn",pageSize:10,placeholder:"æ¥å†™è¯„è®ºå§ ...",recordIP:!0,visitor:!0}},lightGallery:{actualSize:!1,exThumbImage:"data-thumbnail",hideBarsDelay:2e3,selector:".lightgallery",speed:400,thumbContHeight:80,thumbWidth:80,thumbnail:!0}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>